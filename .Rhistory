library(Matrix)
library(lme4)
library(reshape2)
library(rrBLUP)
library(ggplot2)
spectra <- read.csv("Raw_spectrum_merged")
spectra$Rep <- factor(spectra$Rep)
spectra$Block <- factor(spectra$Block)
spectra$year <- factor(spectra$year)
spectra$genotype <- factor(spectra$genotype)
spectra$note <- factor(spectra$note)
spectra$Trt <- factor(spectra$Trt)
spectra$ASD <- factor(spectra$ASD)
spectra <- subset(spectra, select = -X)
library(Matrix)
library(lme4)
library(reshape2)
library(rrBLUP)
library(ggplot2)
spectra <- read.csv("Raw_spectrum_merged")
str(spectra)
spectra$Rep <- factor(spectra$Rep)
spectra$Block <- factor(spectra$Block)
spectra$year <- factor(spectra$year)
spectra$genotype <- factor(spectra$genotype)
spectra$note <- factor(spectra$note)
spectra$Trt <- factor(spectra$Trt)
spectra$ASD <- factor(spectra$ASD)
spectra <- subset(spectra, select = -X)
spcetra.blups_HN <- read.csv('spectrum_blups_HN.csv')
spcetra.blups_LN <- read.csv('spectrum_blups_LN.csv')
View(spectra.blups_HN)
spcetra.blups_HN <- read.csv('spectrum_blups_HN.csv')
spcetra.blups_LN <- read.csv('spectrum_blups_LN.csv')
View(spectra.blups_HN)
spcetra.blups.HN <- read.csv('spectrum_blups_HN.csv')
spcetra.blups.LN <- read.csv('spectrum_blups_LN.csv')
spectra.blups.sub.melt <- read.csv('fullspectra_plots.csv')
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))+
labs(title = 'Leaf Spectra (BLUPs)', x='bands' , y = 'reflectance')
library(Matrix)
library(lme4)
library(reshape2)
library(rrBLUP)
library(ggplot2)
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))+
labs(title = 'Leaf Spectra (BLUPs)', x='bands' , y = 'reflectance')
ggplot(spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),], aes(wavelength, value, color=genotype)) +
geom_line(size=0.3)+
theme(legend.position = 'none')
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))+
)
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+ geom_line(aes(wavelength, value, color=Trt, alpha=0.4))
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot()+
geom_line(data = spectra.blups.sub.melt, aes(wavelength, value, color=Trt, alpha=0.4))
View(spectra.blups.sub.melt)
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
plot <- ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))+
labs(title='Leaf Spectra (BLUPs)', x='bands', y = 'reflectance')
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
plot <- ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))+
labs(title='Leaf Spectra (BLUPs)', x='bands', y = 'reflectance')
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
plot1 <- ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))+
labs(title='Leaf Spectra (BLUPs)', x='bands', y = 'reflectance')
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))+
labs(title='Leaf Spectra (BLUPs)', x='bands', y = 'reflectance')
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))+
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))+
sa
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))+
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))
spectra.blups.sub.melt <- read.csv('fullspectra_plots.csv')
ggplot() +
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'HN'),],aes(wavelength, value, color='green', alpha=0.4))+
geom_line(data=spectra.blups.sub.melt[which(spectra.blups.sub.melt$Trt == 'LN'),], aes(wavelength, value, color='yellow', alpha=0.4))+
scale_color_manual(name='Treatment', breaks = c('g', 'a'),  values = c('HN'= 'green', 'LN' = 'yellow'))
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt))+
labs(title = 'Leaf spectra (BLUPS)', x='bands', y='reflectance')
ggplot(data = spectra.blups.sub.melt)+
geom_line(aes(wavelength, value, color=Trt, alpha=0.4))+
labs(title = 'Leaf spectra (BLUPS)', x='bands', y='reflectance')
library(Matrix)
library(lme4)
library(reshape2)
library(rrBLUP)
library(ggplot2)
library(ggpubr)
spectra <- read.csv("Raw_spectrum_merged")
spectra$Rep <- factor(spectra$Rep)
spectra$Block <- factor(spectra$Block)
spectra$year <- factor(spectra$year)
spectra$genotype <- factor(spectra$genotype)
spectra$note <- factor(spectra$note)
spectra$Trt <- factor(spectra$Trt)
spectra$ASD <- factor(spectra$ASD)
spectra <- subset(spectra, select = -X)
spectra.sub <- spectra #[which(spectra$ASD %in% c(1,2)),]
spectra.sub.melt <- melt(spectra.sub, id.vars = c('PLOT.ID', 'Block' ,'Rep', 'Trt', 'year', 'genotype', 'note', 'Calibration', 'ASD'))
View(spectra.sub.melt)
colnames(spectra.sub.melt)[10:11] <- c('band', 'reflectance')
spectra.sub.melt$band <- as.character(spectra.sub.melt$band)
spectra.sub.melt$band <- as.numeric(substr(spectra.sub.melt$band,2,5))
spectra.sub.melt$band
head(bands.H2)
ggplot(data=spectra.sub.melt, aes(band, reflectance, color=Trt, alpha=0.4)) + geom_line()
ggplot(data=spectra.sub.melt) + geom_line(aes(band, reflectance, color=Trt, alpha=0.4))
