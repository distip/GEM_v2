#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = Trt, y = heterosis, fill= bands)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, aes(x = Trt, y = heterosis, Fill= male))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values')
box_mid <- ggplot(data = analysis_mid_merge, aes(x = Trt, y = heterosis, fill= bands)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, aes(x = Trt, y = heterosis, Fill= male))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = Trt, y = heterosis, fill= bands)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, aes(x = Trt, y = heterosis, fill= male))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male) +
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male) +
geom_boxplot(width=0.1, aes(x = Trt, y = heterosis, fill= male))
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values')
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, aes(x = Trt, y = heterosis, fill= male))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, aes(x = bands, y = heterosis, fill= male))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, aes(x = bands, y = heterosis, fill= Trt))
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values')
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, aes(x = bands, y = heterosis, fill= Trt), jitter= 1)
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, aes(x = bands, y = heterosis, fill= Trt))
box_
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=1, aes(x = bands, y = heterosis, fill= Trt))
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.8, aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=1, aes(x = bands, y = heterosis, fill= Trt))
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_violin(trim = FALSE)+
geom_boxplot(width=0.1, position=position_dodge(0.9),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(trim = FALSE)+
geom_boxplot(width=0.1, position=position_dodge(0.9),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot()+
geom_boxplot(width=0.1, position=position_dodge(0.9),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1)+
geom_boxplot(width=0.1, position=position_dodge(0.9),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1)+
geom_boxplot(width=0.5, position=position_dodge(0.9),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
analysis_mid_LN <- mid_LN[mid_LN$bands %in%  c('550', '710', '1445', '1890', '2020', '2410'),] # %>% distinct(genotype, .keep_all = TRUE)
analysis_mid_HN <- mid_HN[mid_HN$bands %in% c('550', '710', '1445', '1890', '2020', '2410') ,] # %>% distinct(genotype, .keep_all = TRUE)
analysis_mid_HN$Trt <- c(rep('HN', length(analysis_mid_HN$bands)))
analysis_mid_LN$Trt <- c(rep('LN', length(analysis_mid_LN$bands)))
analysis_mid_merge <- analysis_mid_HN %>% full_join(analysis_mid_LN)
analysis_mid_merge$bands <- factor(analysis_mid_merge$bands)
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1)+
geom_boxplot(width=0.5, position=position_dodge(0.9),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.2, position = Trt)+
geom_boxplot(width=0.5, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.2, position = 1)+
geom_boxplot(width=0.5, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.2, position = position_dodge(0.1))+
geom_boxplot(width=0.5, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.2, position = position_dodge(0.1))+
geom_boxplot(width=0.5, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_dodge(0.1))+
geom_boxplot(width=0.5, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_dodge(0.5))+
geom_boxplot(width=0.5, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_dodge(0.3))+
geom_boxplot(width=0.5, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_dodge(0.2))+
geom_boxplot(width=0.5, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_dodge(0.2))+
geom_boxplot(width=0.5, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values in 6 hotspots')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_dodge(0.2))+
geom_boxplot(width=0.5, position=position_dodge(1),  aes(x = bands, y = heterosis, fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.2, position = position_dodge(0.2))+
geom_boxplot(width=0.2, position=position_dodge(0.5),  aes(x = bands, y = heterosis, fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.2, position = position_dodge(0.2))+
geom_boxplot(width=0.2, position=position_dodge(0.8),  aes(x = bands, y = heterosis, fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.2, position = position_dodge(0.2))+
geom_boxplot(width=0.4, position=position_dodge(0.8),  aes(x = bands, y = heterosis, fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.2, position = position_dodge(0.2))+
geom_boxplot(width=0.4, position=position_dodge(0.9),  aes(x = bands, y = heterosis, fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_dodge(0.2))+
geom_boxplot(width=0.4, position=position_dodge(0.9),  aes(x = bands, y = heterosis, fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
write_csv(mid_LN, 'mid_LN.csv')
write_csv(mid_HN, 'mid_HN.csv')
write_csv(low_LN, 'low_LN.csv')
data_low_HN <- low_HN[low_HN$male %in% c("B73", "Mo17"),] %>% group_by(male,bands) %>%
summarise(mean.heterosis = mean(heterosis, na.rm=TRUE), sd.heterosis = sd(heterosis, na.rm = TRUE), se.heterosis= sd(heterosis, na.rm=TRUE)/sqrt(length(heterosis)),
max = max(heterosis, na.rm = TRUE), min = min(heterosis, na.rm = TRUE))
write_csv(low_HN, 'low_HN.csv')
write_csv(better_LN, 'better_LN.csv')
write_csv(better_HN, 'better_HN.csv')
t.test(analysis_mid_HN[analysis_mid_HN$bands == '2410', 'heterosis'], analysis_mid_LN[analysis_mid_LN$bands == '2410', "heterosis"], var.equal = FALSE)
View(nalysis_mid_HN[analysis_mid_HN$bands == '2410', 'heterosis'])
View(analysis_mid_HN[analysis_mid_HN$bands == '2410', 'heterosis'])
View(analysis_mid_HN[analysis_mid_HN$bands == "2410", "heterosis"])
View(analysis_mid_HN[analysis_mid_HN$bands == '2410', heterosis])
t.test(analysis_mid_HN[analysis_mid_HN$bands == '2410', heterosis], analysis_mid_LN[analysis_mid_LN$bands == '2410', heterosis], var.equal = FALSE)
t.test(analysis_mid_HN[analysis_mid_HN$bands == '2410', 'heterosis'], analysis_mid_LN[analysis_mid_LN$bands == '2410', 'heterosis'], var.equal = FALSE)
box
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_dodge(0.2))+
geom_boxplot(width=0.4, position=position_dodge(0.9),  aes(x = bands, y = heterosis, fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
t.test(analysis_mid_HN[analysis_mid_HN$bands == '2020', 'heterosis'], analysis_mid_LN[analysis_mid_LN$bands == '2020', 'heterosis'], var.equal = FALSE)
t.test(analysis_mid_HN[analysis_mid_HN$bands == '2020', 'heterosis'], analysis_mid_LN[analysis_mid_LN$bands == '2020', 'heterosis'], var.equal = TRUE)
t.test(analysis_mid_HN[analysis_mid_HN$bands == '2410', 'heterosis'], analysis_mid_LN[analysis_mid_LN$bands == '2020', 'heterosis'], var.equal = TRUE)
t.test(analysis_mid_HN[analysis_mid_HN$bands == '2410', 'heterosis'], analysis_mid_LN[analysis_mid_LN$bands == '2410', 'heterosis'], var.equal = TRUE)
t.test(analysis_mid_HN[analysis_mid_HN$bands == '1890', 'heterosis'], analysis_mid_LN[analysis_mid_LN$bands == '1890', 'heterosis'], var.equal = TRUE)
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_dodge(0.2))+
geom_boxplot(width=0.4, position=position_dodge(0.9),  aes(fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_nudge(x = 2))+
geom_boxplot(width=0.4, position=position_dodge(0.9),  aes(fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_nudge(x = 0.3))+
geom_boxplot(width=0.1, position=position_nudge(x = -0.3),  aes(fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_nudge(x = 0.3), position = position_dodge(0.3))+
geom_boxplot(width=0.1, position=position_nudge(x = -0.3),  aes(fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = (position_nudge(x = 0.3), position_dodge(0.3)))+
geom_boxplot(width=0.1, position=position_nudge(x = -0.3),  aes(fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = (position_nudge(x = 0.3)+ position_dodge(0.3)))+
geom_boxplot(width=0.1, position=position_nudge(x = -0.3),  aes(fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = (position_nudge(x = 0.3)+ position_dodge(0.3)))+
geom_boxplot(width=0.1, position=position_nudge(x = -0.3),  aes(fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_nudge(x = 0.3))+
geom_boxplot(width=0.1, position=position_nudge(x = -0.3),  aes(fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_nudge(x = 0.2))+
geom_boxplot(width=0.1, position=position_nudge(x = -0.2),  aes(fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
box_mid
box_mid <- ggplot(data = analysis_mid_merge, aes(x = bands, y = heterosis, fill= male)) +
geom_boxplot(width=0.1, position = position_dodgenudge(width=1))+
geom_boxplot(width=0.1, position= position_nudge(x = -0.2),  aes(fill= Trt))+
#annotate('text' , x=0.8 , y= 22, label='p-value < 2.2e-16')+
labs(title = 'MPH values of Spectra in 6 hotspots')
blues <- read_csv('spectra_blues.csv')
blues <- read.csv('spectra_blues.csv')
blues <- as.data.frame(blues)
blues <- blues %>% select(-contains(c('.x', '.y', '.z')))
library(tidyverse)
#library(FactoMineR)
library(ggplot2)
blues <- blues %>% select(-contains(c('.x', '.y', '.z')))
blues <- blues[ , colSums(is.na(blues))==0]
str(blues)
blues$genotype <- as.factor(blues$genotype)
blues$PLOT.ID <- as.factor(blues$PLOT.ID)
blues$rows <- as.factor(blues$rows)
blues$ranges <- as.factor(blues$ranges)
blues$Block <- as.factor(blues$Block)
blues$Rep <- as.factor(blues$Rep)
blues$Trt <- as.factor(blues$Trt)
blues$year <- as.factor(blues$year)
blues$note <-as.factor(blues$note)
blues$Calibration <- as.factor(blues$Calibration)
blues$ASD <- as.factor(blues$ASD)
View(blues)
res.pca <- prcomp(blues[ , 11:length(colnames(blues))], scale = FALSE)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
library(factoextra)
library(FactoMineR)
library(factoMineR)
library(FactoMineR)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
library(factoextra)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
ggplot(cbind(basic_plot$data, blues[, c('Trt', 'note', 'Group')]), aes(x=x, y=y, shape=Trt, col=note))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
ggplot(cbind(basic_plot$data, blues[, c('Trt', 'note', 'Group')]), aes(x=x, y=y, col=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
ggplot(cbind(basic_plot$data, blues[, c('Trt', 'note', 'Group')]), aes(x=x, y=y, col=Group))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
res.pca <- prcomp(blues[blues[blues$Trt == 'HN'] , 11:length(colnames(blues))], scale = FALSE)
res.pca <- prcomp(blues[blues$Trt == 'HN' , 11:length(colnames(blues))], scale = FALSE)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
ggplot(cbind(basic_plot$data, blues[blues$Trt == 'HN', c('Trt', 'note', 'Group')]), aes(x=x, y=y, col=Group))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
res.pca <- prcomp(blues[blues$Trt == 'LN' , 11:length(colnames(blues))], scale = FALSE)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
basic_plot
ggplot(cbind(basic_plot$data, blues[blues$Trt == 'LN', c('Trt', 'note', 'Group')]), aes(x=x, y=y, col=Group))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
basic_plot
library(Matrix)
library(lme4)
library(reshape2)
library(rrBLUP)
library(ggplot2)
library(tidyverse)
library(viridisLite)
library(viridis)
spectra <- read.csv("Raw_spectrum_merged")
View(spectra)
str(spectra)
spectra$Rep <- factor(spectra$Rep)
spectra$Block <- factor(spectra$Block)
spectra$year <- factor(spectra$year)
spectra$genotype <- factor(spectra$genotype)
spectra$note <- factor(spectra$note)
spectra$Trt <- factor(spectra$Trt)
spectra$ASD <- factor(spectra$ASD)
spectra$Group <- factor(spectra$Group)
spectra$rows <- factor(spectra$rows)
spectra$ranges <- factor(spectra$ranges)
spectra$PLOT.ID <- factor(spectra$PLOT.ID)
spectra$ASD  <- factor(spectra$ASD)
spectra$Calibration <- factor(spectra$Calibration)
spectra <- subset(spectra, select = -c(X, Unnamed..0))
blues <- read.csv('spectra_blues.csv')
blues <- as.data.frame(blues)
blues <- blues %>% select(-contains(c('.x', '.y', '.z')))
blues <- blues[ , colSums(is.na(blues))==0]
str(blues)
blues$genotype <- as.factor(blues$genotype)
blues$PLOT.ID <- as.factor(blues$PLOT.ID)
blues$rows <- as.factor(blues$rows)
blues$ranges <- as.factor(blues$ranges)
blues$Block <- as.factor(blues$Block)
blues$Rep <- as.factor(blues$Rep)
blues$Trt <- as.factor(blues$Trt)
blues$year <- as.factor(blues$year)
blues$note <-as.factor(blues$note)
blues$Calibration <- as.factor(blues$Calibration)
blues$ASD <- as.factor(blues$ASD)
blues$genotype <- as.factor(blues$genotype)
res.pca <- prcomp(blues[blues$Trt == 'LN' , 11:length(colnames(blues))], scale = FALSE)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
res.pca <- prcomp(blues[blues$Trt == 'LN' , 11:length(colnames(blues))], scale = FALSE)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
library(FactoMineR)
library(ggplot2)
library(factoextra)
library(tidyverse)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
basic_plot
ggplot(cbind(basic_plot$data, blues[blues$Trt == 'LN', c('Trt', 'note', 'Group')]), aes(x=x, y=y, col=Group))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
res.pca <- prcomp(blues[blues$Trt == 'HN' , 11:length(colnames(blues))], scale = FALSE)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
basic_plot
ggplot(cbind(basic_plot$data, blues[blues$Trt == 'HN', c('Trt', 'note', 'Group')]), aes(x=x, y=y, col=Group))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
levels(spectra$Trt)
for(i in 1:2){
### To get started, a dataframe containing only the "gid" column can be created for each
### element of the list.
spectra.blues.list[[i]] <- data.frame(levels(spectra$genotype))
colnames(spectra.blues.list[[i]]) <- 'genotype'
}
spectra.blues.list <- vector('list', 2)
for(i in 1:2){
### To get started, a dataframe containing only the "gid" column can be created for each
### element of the list.
spectra.blues.list[[i]] <- data.frame(levels(spectra$genotype))
colnames(spectra.blues.list[[i]]) <- 'genotype'
}
names(spectra.blues.list) <- c('HN', 'LN')
spectra.blues.list[1]
names(spectra.blues.list)[1]
blues_plot <- melt(blues, id.vars = c('PLOT.ID', 'genotype','rows', 'ranges', 'Block' ,'Rep', 'Trt', 'year', 'note', 'Calibration', 'ASD', 'Group'))
blues_plot <- melt(blues, id.vars = c('PLOT.ID', 'genotype','rows', 'ranges', 'Block' ,'Rep', 'Trt', 'year', 'note', 'Group'))
View(blues)
a <- sapply(strsplit(as.character(blues_plot$variable), '[.]'), '[[', 1)
blues_plot$wavelength <- as.numeric(substr(a,2,5))
blues_plot$wavelength <- as.numeric(blues_plot$wavelength)
data <- blues_plot %>% group_by(wavelength,note) %>%
summarise(mean.ref = mean(value, na.rm=TRUE), sd.ref = sd(value, na.rm = TRUE), se.ref= sd(value, na.rm=TRUE)/sqrt(length(value)),
max = max(value, na.rm = TRUE), min = min(value, na.rm = TRUE))
plt_blues <- ggplot(data=data, aes(x=wavelength, group= note)) +
geom_line(aes(y=mean.ref, color=note), size = 0.6)+
geom_ribbon(aes(ymin=mean.ref-se.ref , ymax=mean.ref+se.ref , fill=note),alpha=0.3)+
labs(title = 'Leaf Spectra inbred vs hybrids under HN', caption = '**Envelopes represent 1 sd from the mean')+
theme_bw()
plt_blues
plt_blues <- ggplot(data=data, aes(x=wavelength, group= Group)) +
geom_line(aes(y=mean.ref, color=note), size = 0.6)+
geom_ribbon(aes(ymin=mean.ref-se.ref , ymax=mean.ref+se.ref , fill=note),alpha=0.3)+
labs(title = 'Leaf Spectra inbred vs hybrids under HN', caption = '**Envelopes represent 1 sd from the mean')+
theme_bw()
plt_blues
plt_blues <- ggplot(data=data, aes(x=wavelength, group= Group)) +
geom_line(aes(y=mean.ref, color=Group), size = 0.6)+
geom_ribbon(aes(ymin=mean.ref-se.ref , ymax=mean.ref+se.ref , fill=Group),alpha=0.3)+
labs(title = 'Leaf Spectra inbred vs hybrids under HN', caption = '**Envelopes represent 1 sd from the mean')+
theme_bw()
plt_blues
View(data)
data <- blues_plot %>% group_by(wavelength,Group) %>%
summarise(mean.ref = mean(value, na.rm=TRUE), sd.ref = sd(value, na.rm = TRUE), se.ref= sd(value, na.rm=TRUE)/sqrt(length(value)),
max = max(value, na.rm = TRUE), min = min(value, na.rm = TRUE))
plt_blues <- ggplot(data=data, aes(x=wavelength, group= Group)) +
geom_line(aes(y=mean.ref, color=Group), size = 0.6)+
geom_ribbon(aes(ymin=mean.ref-se.ref , ymax=mean.ref+se.ref , fill=Group),alpha=0.3)+
labs(title = 'Leaf Spectra inbred vs hybrids under HN', caption = '**Envelopes represent 1 sd from the mean')+
theme_bw()
plt_blues
plt_blues <- ggplot(data=data, aes(x=wavelength, group= genotype)) +
geom_line(aes(y=mean.ref, color=Group), size = 0.6)+
geom_ribbon(aes(ymin=mean.ref-se.ref , ymax=mean.ref+se.ref , fill=Group),alpha=0.3)+
labs(title = 'Leaf Spectra inbred vs hybrids under HN', caption = '**Envelopes represent 1 sd from the mean')+
theme_bw()
plt_blues
data <- blues_plot %>% group_by(genotype,wavelength,Group) %>%
summarise(mean.ref = mean(value, na.rm=TRUE), sd.ref = sd(value, na.rm = TRUE), se.ref= sd(value, na.rm=TRUE)/sqrt(length(value)),
max = max(value, na.rm = TRUE), min = min(value, na.rm = TRUE))
ggplot(data = blues)+
geom_line(aes(wavelength, value, group=genotype, color=Trt), size=0.1)+
labs(title = 'Leaf spectra (BLUES)', x='bands', y='reflectance')
ggplot(data = blues_plot)+
geom_line(aes(wavelength, value, group=genotype, color=Trt), size=0.1)+
labs(title = 'Leaf spectra (BLUES)', x='bands', y='reflectance')
blues_plot_2 <- ggplot() +
geom_line(data=blues_plot[which(blues_plot$Trt == 'LN'),],aes(wavelength, value, group= genotype, color='LN'), size=0.1)+
geom_line(data=blues_plot[which(blues_plot$Trt == 'HN'),], aes(wavelength, value, group= genotype, color='HN'), size=0.1)+
scale_color_manual(name='Treatment',  values = c('HN'= 'green', 'LN' = 'yellow'))
blues_plot_2
blues_plot_2 <- ggplot() +
geom_line(data=blues_plot[which(blues_plot$Trt == 'HN'),],aes(wavelength, value, group= genotype, color='LN'), size=0.05)+
geom_line(data=blues_plot[which(blues_plot$Trt == 'LN'),], aes(wavelength, value, group= genotype, color='HN'), size=0.05)+
scale_color_manual(name='Treatment',  values = c('HN'= 'green', 'LN' = 'yellow'))
blues_plot_2
blues_plot_2 <- ggplot() +
geom_line(data=blues_plot[which(blues_plot$Trt == 'HN'),],aes(wavelength, value, group= genotype, color='HN'), size=0.05)+
geom_line(data=blues_plot[which(blues_plot$Trt == 'LN'),], aes(wavelength, value, group= genotype, color='LN'), size=0.05)+
scale_color_manual(name='Treatment',  values = c('HN'= 'green', 'LN' = 'yellow'))
blues_plot_2
blues_plot_2 <- ggplot() +
geom_line(data=blues_plot[which(blues_plot$Trt == 'LN'),],aes(wavelength, value, group= genotype, color='LN'), size=0.05)+
geom_line(data=blues_plot[which(blues_plot$Trt == 'HN'),], aes(wavelength, value, group= genotype, color='HN'), size=0.05)+
scale_color_manual(name='Treatment',  values = c('HN'= 'green', 'LN' = 'yellow'))
blues_plot_2
ggplot(cbind(basic_plot$data, blues[, c('Trt', 'note', 'Group')]), aes(x=x, y=y, col=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
res.pca <- prcomp(blues[ , 11:length(colnames(blues))], scale = FALSE)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
ggplot(cbind(basic_plot$data, blues[, c('Trt', 'note', 'Group')]), aes(x=x, y=y, col=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
ggplot(cbind(basic_plot$data, blues[, c('Trt', 'note', 'Group')]), aes(x=x, y=y, col=Trt))+
geom_point(size=2)+
labs(title = 'PCA BLUES', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
ggplot(cbind(basic_plot$data, blues[, c('Trt', 'note', 'Group')]), aes(x=x, y=y, shape=Group , col=Trt))+
geom_point(size=2)+
labs(title = 'PCA BLUES', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
ggplot(cbind(basic_plot$data, blues[, c('Trt', 'note', 'Group')]), aes(x=x, y=y, shape=Group , col=Trt))+
geom_point(size=2)+
scale_shape_manual(values = c(8, 16))+
labs(title = 'PCA BLUES', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
ggplot(cbind(basic_plot$data, blues[, c('Trt', 'note', 'Group')]), aes(x=x, y=y, shape=Group , col=Trt))+
geom_point(size=2)+
scale_shape_manual(values = c(1, 16))+
labs(title = 'PCA BLUES', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
#stat_ellipse()+
theme_bw(14)
blues_plot_2 <- ggplot() +
geom_line(data=blues_plot[which(blues_plot$Trt == 'HN'),],aes(wavelength, value, group= genotype, color='HN'), size=0.05)+
geom_line(data=blues_plot[which(blues_plot$Trt == 'LN'),], aes(wavelength, value, group= genotype, color='LN'), size=0.05)+
scale_color_manual(name='Treatment',  values = c('HN'= 'green', 'LN' = 'yellow'))
blues_plot_2
