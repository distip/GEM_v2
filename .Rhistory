theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, shape=Trt, col = Group ))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(show.legend = FALSE)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, shape=Trt, col = Group ))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(type= norm)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, shape=Trt, col = Group ))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(type= 'norm')+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, shape=Trt, col = Group ))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(type= 't')+
theme_bw(14)
install.packages(gpbStat)
install.packages('gpbStat')
library(gpbStat)
hybrids <- blups[blups$note == 'Hybrid',]
View(hybrids)
hbrids <- hybrids %>% filter(grepl(' X ', genotype))
hbrids <- hybrids %>% filter(grepl(' X ', genotype))
View(hybrids)
hybrids <- blups[blups$note == 'Hybrid',]
hbrids <- hybrids %>% filter(grepl(' X ', genotype))
hbrids <- hybrids %>% filter(grepl(' X ', genotype))
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
hybrids <- hybrids %>% filter(grepl(' X ', hybrids$genotype))
View(hybrids)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', hybrids$genotype))
View(hybrids)
hybrids <- hybrids %>% filter(grepl(' X ', 'genotype'))
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', 'genotype'))
View(hybrids)
hybrids$gentoype <- as.character(hybrids$genotype)
hybrids$gentoype <- character(hybrids$genotype)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids$gentoype <- character(hybrids$genotype)
hybrids$gentoype <- as.character(hybrids$genotype)
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
hybrids <- hybrids %>% filter(grepl(' X ', hybrids$genotype))
View(hybrids)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids$gentoype <- as.character(hybrids$genotype)
hybrids <- hybrids %>% filter(grepl(' X ', hybrids$genotype))
View(hybrids)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids$gentoype <- as.character(hybrids$genotype)
hybrids <- hybrids %>% filter(grepl(' X ',genotype))
hybrids <- blups[blups$note == 'Hybrid',]
hybrids$gentoype <- as.factor(hybrids$genotype)
hybrids <- hybrids %>% filter(grepl(' X ',genotype))
hybrids <- blups[blups$note == 'Hybrid',]
str(hybrids)
hybrids$gentoype <- as.factor(hybrids$genotype)
str(hybrids)
hybrids$gentoype <- factor(hybrids$genotype)
str(hybrids)
hybrids <- hybrids %>% filter(grepl(' X ',genotype))
hybrids <- blups[blups$note == 'Hybrid',]
hybrids$gentoype <- factor(hybrids$genotype)
str(hybrids)
hybrids <- hybrids %>% filter(grepl(' X ',genotype))
hybrids %>% filter(grepl(' X ',genotype))
hybrids <- blups[blups$note == 'Hybrid',]
hybrids %>% filter(grepl(' X ',genotype))
hybrids %>% filter(grepl(' X ', genotype))
hybrids %>% filter(grepl(' X ', factor(genotype)))
library(tidyverse)
hybrids %>% filter(grepl(' X ', genotype))
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
View(hybrids)
female <- c()
male <- c()
for (i in 1:length(hybrids$note)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
male
library(tidyverse)
library(gpbStat)
hybrids <- blups[blups$note == 'Hybrid',]
str(hybrids)
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
View(hybrids)
female <- c()
male <- c()
for (i in 1:length(hybrids$note)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
male
View(hybrids)
blups <- blups %>% filter(Rep == 1)
res.pca <- prcomp(blups[,13:length(colnames(blups))], scale = FALSE)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
library(factoextra)
fviz_pca_ind(res.pca, geom="point")
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, shape=Trt, col = Group ))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(type= 't')+
theme_bw(14)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
View(hybrids)
female <- c()
male <- c()
for (i in 1:length(hybrids$note)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
View(hybrids)
male
female
female <- c()
male <- c()
for (i in 1:length(hybrids$genotype)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
male
female <- c()
male <- c()
for (i in 1:length(hybrids$genotype)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
male
hybrids <- hybrids %>% mutate(male = male , female = female, before. = note)
View(hybrids)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
hybrids <- hybrids %>% mutate(male = male , female = female, .before = note)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
hybrids <- hybrids %>% mutate(female = female , male = male, .before = note)
result <- ltc(hybrids, rep, female, male, X730, block)
result <- ltc(hybrids, rep, female, male, X730, block)
str(hybrids)
result <- ltc(hybrids[hybrids$Trt= 'LN',], rep, female, male, X730, block)
result <- ltc(hybrids[hybrids$Trt == 'LN',], rep, female, male, X730, block)
View(hybrids[hybrids$Trt == 'LN',])
result <- ltc(hybrids[hybrids$Trt == 'LN' & hybrids$male == 'B73',], rep, female, male, X730, block)
result <- ltc(hybrids, Rep, female, male, X730, block)
result <- ltc(hybrids, Rep, female, male, X730, Block)
result <- ltc(hybrids, Rep, female, male, X730, Block)
result <- ltc(hybrids[hybrids$Trt == 'LN'], Rep, female, male, X730, Block)
subset(hybrid, select = c(Rep, female, male, X730, Block))
subset(hybrid, select = c(Rep, female, male, 'X730', Block))
result <- ltc(hybrids[hybrids$Trt == 'LN'], Rep, female, male, X350, Block)
subset(hybrid, select = c(Rep, female, male, X350, Block))
subset(hybrid, select = c('X350'))
subset(hybrid, select = c(X350))
subset(hybrid, select = c(Rep))
colnames(hybrids)[0:15]
result <- ltc(hybrids[hybrids$Trt == 'LN'], Rep, female, male, X350, Block)
subset(hybrid, select = c(X350))
subset(hybrid, select = c('X350'))
subset(hybrid, select = c(X350))
subset(hybrids, select = c(X350))
result <- ltc(hybrids[hybrids$Trt == 'LN'], Rep, female, male, X350)
result <- ltc(hybrids, Trt, female, male, X350)
blups <- read.csv('spectra_blups.csv')
blups <- read.csv('spectra_blups.csv')
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
female <- c()
male <- c()
for (i in 1:length(hybrids$genotype)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
hybrids <- hybrids %>% mutate(female = female , male = male, .before = note)
result <- ltc(hybrids, Trt, female, male, X350)
length(hybrids$Trt)
length(hybrids$female)
length(hybrids$male)
length(hybrids$X350)
result <- ltc(hybrids, Rep, female, male, X350)
View(hybrids)
result <- ltc(hybrids[hybrids$Trt == 'LN',], Rep, female, male, X350)
result <- ltc(hybrids[hybrids$Trt == 'LN' $ hybrids$male == 'Mo17',], Rep, female, male, X350)
result <- ltc(hybrids[hybrids$Trt == 'LN' & hybrids$male == 'Mo17',], Rep, female, male, X350)
result <- ltc(hybrids[hybrids$Trt == 'LN' & hybrids$male == 'Mo17',], Rep, female, male, X350)
length(as.factor(hybrids$Rep))
length(as.factor(hybrids$female))
length(as.factor(hybrids$male))
result <- ltc(hybrids[hybrids, Rep, female, male, X350)
result <- ltc(hybrids, Rep, female, male, X350)
result <- ltc(hybrids, Rep, female, male, X350, Block)
result <- ltc(hybrids, Rep, female, male, X350)
########################   CALCULATION OF Better-PARENT HETEROSIS   #####################################
## heterosis calculation for low nitrogen condition
blups_LN <- blups[blups$Trt == 'LN' & blups$Rep == 1 ,]
het <- blups_LN %>% filter(grepl(' X ', genotype))
heterosis.val_LN <- expand.grid(bands= 350:2500, genotype = het$genotype)
heterosis.val_LN$heterosis <- NA
max(c(1,3,4,6))
########################   CALCULATION OF Better-PARENT HETEROSIS   #####################################
## heterosis calculation for low nitrogen condition
blups_LN <- blups[blups$Trt == 'LN' & blups$Rep == 1 ,]
het <- blups_LN %>% filter(grepl(' X ', genotype))
heterosis.val_LN <- expand.grid(bands= 350:2500, genotype = het$genotype)
heterosis.val_LN$heterosis <- NA
for(i in 1:length(het$genotype)){
for(j in 12:length(colnames(het))){
hybrid <- as.character(het$genotype[i])
female <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][1]
male <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][2]
if(mean(blups_LN$genotype %in% c(female)) > 0 & mean(blups_LN$genotype %in% c(male) > 0 )) {
female2 <- mean(blups_LN[which(blups_LN$genotype == female ), j])
male2 <- mean(blups_LN[which(blups_LN$genotype == male ), j])
better <- max(c(female2, male2))
hybrid2 <- mean(blups_LN[which(blups_LN$genotype == hybrid ), j])
heterosis <- (hybrid2-better)/better*100
heterosis.val_LN[heterosis.val_LN$bands == j+338 & heterosis.val_LN$genotype == hybrid , 'heterosis'] <- heterosis
print(i)
print(j)
}
else
print('pass')
}
}
males <- c()
for(i in 1:length(heterosis.val_LN$genotype)){
male <- strsplit(as.character(heterosis.val_LN$genotype[i]), ' X ')[[1]][2]
males<- c(males,  male)
print(i)
}
heterosis.val_HN$male <- males
heterosis.val_HN <- na.omit(heterosis.val_HN)
heterosis.val_LN$male <- males
heterosis.val_LN <- na.omit(heterosis.val_LN)
data <- heterosis.val_LN[heterosis.val_LN$male %in% c('B73', 'Mo17'),] %>% group_by(male,bands) %>%
summarise(mean.heterosis = mean(heterosis, na.rm=TRUE), sd.heterosis = sd(heterosis, na.rm = TRUE), se.heterosis= sd(heterosis, na.rm=TRUE)/sqrt(length(heterosis)),
max = max(heterosis, na.rm = TRUE), min = min(heterosis, na.rm = TRUE))
p4 <- ggplot(data=data, aes(x=bands, group= male)) +
geom_line(aes(y=mean.heterosis, color=male), size = 0.7)+
geom_ribbon(aes(ymin=mean.heterosis-sd.heterosis , ymax=mean.heterosis+sd.heterosis , fill=male),alpha=0.4)+
labs(title = 'Mid-parent Heterosis in LN', caption = '**Envelopes represent 1 sd from the mean')
p4
p1 <-ggplot(data=heterosis.val_LN , aes(x=bands, y=heterosis, group=genotype, colour=male)) +
geom_line(size=0.4, alpha=0.6)+
labs(title='Mid-Parent Heterosis in Low-Nitrogen', x='bands', y='heterosis %')
p1
p2 <- ggplot(data=heterosis.val_LN[heterosis.val_LN$male %in% c('B73', 'Mo17'),], aes(x=bands, y=heterosis, group=genotype, colour=male)) +
geom_line(size=0.4, alpha=0.6)+
labs(title='Better-Parent Heterosis in High-Nitrogen', x='bands', y='heterosis %')
p2
p4 <- ggplot(data=data, aes(x=bands, group= male)) +
geom_line(aes(y=mean.heterosis, color=male), size = 0.7)+
geom_ribbon(aes(ymin=mean.heterosis-sd.heterosis , ymax=mean.heterosis+sd.heterosis , fill=male),alpha=0.4)+
labs(title = 'Better-parent Heterosis in LN', caption = '**Envelopes represent 1 sd from the mean')
p4
p1 <-ggplot(data=heterosis.val_LN , aes(x=bands, y=heterosis, group=genotype, colour=male)) +
geom_line(size=0.4, alpha=0.6)+
labs(title='Better-Parent Heterosis in Low-Nitrogen', x='bands', y='heterosis %')
p1
theme_set(theme_bw(10))
p1 <-ggplot(data=heterosis.val_LN , aes(x=bands, y=heterosis, group=genotype, colour=male)) +
geom_line(size=0.4, alpha=0.6)+
labs(title='Better-Parent Heterosis in Low-Nitrogen', x='bands', y='heterosis %')
p1
data <- heterosis.val_LN[heterosis.val_LN$male %in% c('B73', 'Mo17'),] %>% group_by(male,bands) %>%
summarise(mean.heterosis = mean(heterosis, na.rm=TRUE), sd.heterosis = sd(heterosis, na.rm = TRUE), se.heterosis= sd(heterosis, na.rm=TRUE)/sqrt(length(heterosis)),
max = max(heterosis, na.rm = TRUE), min = min(heterosis, na.rm = TRUE))
View(data)
p4 <- ggplot(data=data, aes(x=bands, group= male)) +
geom_line(aes(y=mean.heterosis, color=male), size = 0.7)+
geom_ribbon(aes(ymin=mean.heterosis-sd.heterosis , ymax=mean.heterosis+sd.heterosis , fill=male),alpha=0.4)+
labs(title = 'Better-parent Heterosis in LN', caption = '**Envelopes represent 1 sd from the mean')
p4
install.packages('lmdiallel')
install.packages('lmDiallel')
library(lmDiallel)
dmod <- lm(X350 ~ GCA(female, male), SCA.G3(female, male), data = hybrids[hybrids$Trt == 'LN',])
dmod <- lm(X730 ~ GCA(female, male), SCA.G3(female, male), data = hybrids[hybrids$Trt == 'LN',])
blups <- read.csv('spectra_blups.csv')
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
female <- c()
male <- c()
for (i in 1:length(hybrids$genotype)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
hybrids <- hybrids %>% mutate(female = female , male = male, .before = note)
dmod <- lm(X730 ~ GCA(female, male), SCA.G3(female, male), data = hybrids[hybrids$Trt == 'LN',])
dmod <- lm(X730 ~ GCA(female, male), SCA.G3(female, male), data = hybrids[hybrids$Trt == 'LN' & hybrids$male == 'B73',])
warni()
warnings()
anova.diallel(dMod, MSE = 21.05, dfr = 2558)
dmod <- lm(X730 ~ GCA(female, male), SCA.G3(female, male), data = hybrids[hybrids$Trt == 'LN' & hybrids$male == 'B73',])
dMod <- lm(X730 ~ GCA(female, male), SCA.G3(female, male), data = hybrids[hybrids$Trt == 'LN' & hybrids$male == 'B73',])
anova.diallel(dMod, MSE = 21.05, dfr = 2558)
## heterosis calculation for high nitrogen condition
blups_HN <- blups[blups$Trt == 'HN' & blups$Rep == 1 ,]
het <- blups_HN %>% filter(grepl(' X ', genotype))
heterosis.val_HN <- expand.grid(bands= 350:2500, genotype = het$genotype)
heterosis.val_HN$heterosis <- NA
for(i in 1:length(het$genotype)){
for(j in 12:length(colnames(het))){
hybrid <- as.character(het$genotype[i])
female <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][1]
male <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][2]
if(mean(blups_HN$genotype %in% c(female)) > 0 & mean(blups_HN$genotype %in% c(male) > 0 )) {
female2 <- mean(blups_HN[which(blups_HN$genotype == female ), j])
male2 <- mean(blups_HN[which(blups_HN$genotype == male ), j])
better <- max(c(female2, male2))
hybrid2 <- mean(blups_HN[which(blups_HN$genotype == hybrid ), j])
heterosis <- (hybrid2-better)/better*100
heterosis.val_HN[heterosis.val_HN$bands == j+338 & heterosis.val_HN$genotype == hybrid , 'heterosis'] <- heterosis
print(i)
print(j)
}
else
print('pass')
}
}
males <- c()
for(i in 1:length(heterosis.val_HN$genotype)){
male <- strsplit(as.character(heterosis.val_HN$genotype[i]), ' X ')[[1]][2]
males<- c(males,  male)
print(i)
}
heterosis.val_HN$male <- males
heterosis.val_HN <- na.omit(heterosis.val_HN)
heterosis.val_HN$male <- factor(heterosis.val_HN$male)
p2 <- ggplot(data=heterosis.val_HN[heterosis.val_HN$male %in% c('B73', 'Mo17'),], aes(x=bands, y=heterosis, group=genotype, colour=male)) +
geom_line(size=0.4, alpha=0.6)+
labs(title='Mid-Parent Heterosis in High-Nitrogen', x='bands', y='heterosis %')
dsa
data <- heterosis.val_HN[heterosis.val_HN$male %in% c('B73', 'Mo17'),] %>% group_by(male,bands) %>%
summarise(mean.heterosis = mean(heterosis, na.rm=TRUE), sd.heterosis = sd(heterosis, na.rm = TRUE), se.heterosis= sd(heterosis, na.rm=TRUE)/sqrt(length(heterosis)),
max = max(heterosis, na.rm = TRUE), min = min(heterosis, na.rm = TRUE))
p4 <- ggplot(data=data, aes(x=bands, group= male)) +
geom_line(aes(y=mean.heterosis, color=male), size = 0.7)+
geom_ribbon(aes(ymin=mean.heterosis-sd.heterosis , ymax=mean.heterosis+sd.heterosis , fill=male),alpha=0.4)+
labs(title = 'Mid-parent Heterosis in HN', caption = '**Envelopes represent 1 sd from the mean')
p4
p2 <- ggplot(data=heterosis.val_HN[heterosis.val_HN$male %in% c('B73', 'Mo17'),], aes(x=bands, y=heterosis, group=genotype, colour=male)) +
geom_line(size=0.4, alpha=0.6)+
labs(title='Mid-Parent Heterosis in High-Nitrogen', x='bands', y='heterosis %')
da
p2
p2 <- ggplot(data=heterosis.val_HN[heterosis.val_HN$male %in% c('B73', 'Mo17'),], aes(x=bands, y=heterosis, group=genotype, colour=male)) +
geom_line(size=0.4, alpha=0.6)+
labs(title='Better-Parent Heterosis in High-Nitrogen', x='bands', y='heterosis %')
p2
p4 <- ggplot(data=data, aes(x=bands, group= male)) +
geom_line(aes(y=mean.heterosis, color=male), size = 0.7)+
geom_ribbon(aes(ymin=mean.heterosis-sd.heterosis , ymax=mean.heterosis+sd.heterosis , fill=male),alpha=0.4)+
labs(title = 'Better-parent Heterosis in HN', caption = '**Envelopes represent 1 sd from the mean')
p4
(hybrid2-better)/better*100
((hybrid2-better)/better)*100
install.packages('agrocolae')
install.packages('agricolae')
library(agricolae)
blups <- read.csv('spectra_blups.csv')
hybrids <- blups[blups$note == 'Hybrid',]
str(hybrids)
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
female <- c()
male <- c()
for (i in 1:length(hybrids$genotype)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
hybrids <- hybrids %>% mutate(female = female , male = male, .before = note)
LN <- hybrids[hybrids$Trt == 'LN']
ouput_LN <- with(LN, lineXtester(Rep, female, male, X350))
View(LN)
blups <- read.csv('spectra_blups.csv')
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
female <- c()
male <- c()
for (i in 1:length(hybrids$genotype)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
hybrids <- hybrids %>% mutate(female = female , male = male, .before = note)
LN <- hybrids[hybrids$Trt == 'LN']
ouput_LN <- with(LN, lineXtester(Rep, female, male, X350))
LN <- hybrids[hybrids$Trt == 'LN']
View(LN)
View(hybrids)
LN <- hybrids[hybrids$Trt == 'LN',]
ouput_LN <- with(LN, lineXtester(Rep, female, male, X350))
LN <- hybrids[hybrids$Trt == 'LN' & hybrids$Rep == 1 ,]
ouput_LN <- with(LN, lineXtester(Rep, female, male, X350))
View(LN)
ouput_LN <- with(LN, lineXtester(Rep, female, male, X350))
LN <- hybrids[hybrids$Trt == 'LN' ,]
ouput_LN <- with(LN, lineXtester(Rep, female, male, X350))
output_LN <- with(LN, lineXtester(Rep, female, male, X350))
output_LN
LN <- hybrids[hybrids$Trt == 'LN' ,]
output_LN <- with(LN, lineXtester(Rep, female, male, X350))
output_LN
LN
View(LN)
output_LN <- with(LN, lineXtester(Rep, female, male, X350))
output_LN <- with(hybrids, lineXtester(Trt, female, male, X350))
LN <- hybrids[hybrids$Rep == 1 ,]
LN <- hybrids[hybrids$Rep == 1 ,]
LN <- hybrids[hybrids$Rep == 1 ,]
output_LN <- with(hybrids, lineXtester(Trt, female, male, X350))
View(LN)
LN <- hybrids[hybrids$Rep == 1 $ hybrids$male == 'B73' ,]
output_LN <- with(LN, lineXtester(Trt, female, male, X350))
LN <- hybrids[hybrids$Rep == 1 $ hybrids$male == 'B73' ,]
output_LN <- with(LN, lineXtester(Trt, female, male, X350))
View(LN)
LN <- hybrids[hybrids$Rep == 1 & hybrids$male == 'B73' ,]
output_LN <- with(LN, lineXtester(Trt, female, male, X350))
View(LN)
LN <- hybrids[hybrids$Rep == 1 & hybrids$male == 'B73' ,]
output_LN <- with(LN, lineXtester(Trt, female, male, X350))
srt(LN)
st(LN)
str(LN)
LN$Trt <- as.factor(LN$Trt)
output_LN <- with(LN, lineXtester(Trt, female, male, X350))
LN$female <-as.factor(LN$female)
LN$male <- as.factor(LN$male)
str(LN)
output_LN <- with(LN, lineXtester(Trt, female, male, X350))
LN <- hybrids[hybrids$Rep == 1 ,]
output_LN <- with(LN, lineXtester(Trt, female, male, X350))
LN <- hybrids[hybrids$Rep == 1 ,]
output_LN <- with(LN, lineXtester(Trt, female, male, X350))
str(LN)
LN$Trt <- as.factor(LN$Trt)
LN$male <- as.factor(LN$male)
LN$female <-as.factor(LN$female)
output_LN <- with(LN, lineXtester(Trt, female, male, X350))
str(LN)
LN <- hybrids
LN$Trt <- as.factor(LN$Trt)
LN$male <- as.factor(LN$male)
LN$female <-as.factor(LN$female)
output_LN <- with(LN, lineXtester(Rep, female, male, X350))
LN <- hybrids[hybrids$Trt == 'HN']
LN$Trt <- as.factor(LN$Trt)
LN$male <- as.factor(LN$male)
LN$female <-as.factor(LN$female)
output_LN <- with(LN, lineXtester(Rep, female, male, X350))
LN <- hybrids[hybrids$Trt == 'HN']
output_LN <- with(LN, lineXtester(Rep, female, male, X350))
blups <- read.csv('spectra_blups.csv')
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
female <- c()
male <- c()
for (i in 1:length(hybrids$genotype)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(hybrids$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
hybrids <- hybrids %>% mutate(female = female , male = male, .before = note)
LN <- hybrids[hybrids$Trt == 'HN']
output_LN <- with(LN, lineXtester(Rep, female, male, X350))
output_LN <- with(LN, lineXtester(Rep, female, male, X730))
output_LN <- with(hybrids, lineXtester(Rep, female, male, X730))
View(hybrids)
grouped <- hybrids %>% group_by(genotype, Rep) %>% summarise(trait = mean(X350), male= mean(male), female = mean(female))
View(grouped)
grouped <- hybrids %>% group_by(genotype, Rep) %>% summarise(trait = mean(X350), male= male, female =female)
output_LN <- with(grouped, lineXtester(Rep, female, male, X730))
output_LN <- with(grouped, lineXtester(Rep, female, male, trait))
