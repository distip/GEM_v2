res<- PCA(spectra[spectra$Trt== 'HN', 12:length(colnames(spectra))])
res<- PCA(spectra[spectra$Trt== 'LN', 12:length(colnames(spectra))])
blups <- read.csv('spectra_blups.csv')
View(blups)
res<- PCA(blups[blups$Trt== 'LN', 12:length(colnames(spectra))])
res<- PCA(blups[blups$Trt== 'HN', 12:length(colnames(spectra))])
summary(res)
res.pca <- prcomp(blups[, 12:length(ncol(blups))], scale = FALSE)
res.pca <- prcomp(blups[, 12:length(colnames(blups))], scale = FALSE)
fviz_pca_ind(res.pca, geom="point")
install.packages(factoextra)
install.packages('factoextra')
fviz_pca_ind(res.pca, geom="point")
library(factoextra)
fviz_pca_ind(res.pca, geom="point")
fviz_pca_ind(res.pca, col.ind="cos2", geom = "point") +
scale_color_gradient2(low="white", mid="blue",
high="red", midpoint=0.6)+ theme_minimal()
fviz_pca_ind(res.pca, label="none", habillage=blups$Trt)
p <- fviz_pca_ind(res.pca, label="none", habillage=iris$Species,
addEllipses=TRUE, ellipse.level=0.95)
print(p)
p <- fviz_pca_ind(res.pca, label="none", habillage=iris$Species,
addEllipses=TRUE, ellipse.level=0.95)
p <- fviz_pca_ind(res.pca, label="none", habillage=blups$note,
addEllipses=TRUE, ellipse.level=0.95)
print(p)
fviz_pca_ind(res.pca, label="none", habillage=blups$note)
p <- fviz_pca_ind(res.pca, label="none", habillage=blups$Trt,
addEllipses=TRUE, ellipse.level=0.95)
print(p)
fviz_pca_ind(res.pca, label="none", habillage=blups$note)
res.pca <- prcomp(blups[blups$Trt== 'HN', 12:length(colnames(blups))], scale = FALSE)
fviz_pca_ind(res.pca, label="none", habillage=blups$note)
fviz_pca_ind(res.pca, geom="point")
fviz_pca_ind(res.pca, col.ind="cos2", geom = "point") +
scale_color_gradient2(low="white", mid="blue",
high="red", midpoint=0.6)+ theme_minimal()
p <- fviz_pca_ind(res.pca, label="none", habillage=blups$Trt,
addEllipses=TRUE, ellipse.level=0.95)
p <- fviz_pca_ind(res.pca, label="none", habillage=blups$note,
addEllipses=TRUE, ellipse.level=0.95)
p <- fviz_pca_ind(res.pca, label="none", habillage=blups[blups$Trt == 'HN', note],
addEllipses=TRUE, ellipse.level=0.95)
p <- fviz_pca_ind(res.pca, label="none", habillage=blups[blups$Trt == 'HN', blups$note],
addEllipses=TRUE, ellipse.level=0.95)
p <- fviz_pca_ind(res.pca, label="none", habillage=blups[blups$Trt == 'HN', 'note'],
addEllipses=TRUE, ellipse.level=0.95)
print(p)
fviz_pca_ind(res.pca, label="none", habillage=blups$note)
fviz_pca_ind(res.pca, label="none", habillage=blups[blups$Trt == 'HN', 'note'])
res.pca <- prcomp(blups[blups$Trt== 'LN', 12:length(colnames(blups))], scale = FALSE)
fviz_pca_ind(res.pca, label="none", habillage=blups[blups$Trt == 'LN', 'note'])
fviz_pca_ind(res.pca, label="none", habillage=blups[blups$Trt == 'LN', 'ASD'])
fviz_pca_ind(res.pca, label="none", habillage=blups[blups$Trt == 'LN', 'note'])
res.pca <- prcomp(blups[blups$Trt== 'HN', 12:length(colnames(blups))], scale = FALSE)
fviz_pca_ind(res.pca, label="none", habillage=blups[blups$Trt == 'HN', 'note'])
# Control the transparency of variables using their contributions
fviz_pca_var(res.pca, alpha.var="contrib") +
theme_minimal()
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.96))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.80))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.50))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.20))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.10))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.05))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.001))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.00000001))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.000001))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0001))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.001))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0001))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0005))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0004))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0003))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0002))
# Select the top 3 contributing variables
fviz_pca_var(res.pca, select.var = list(contrib = 3))
# Select the top 3 contributing variables
fviz_pca_var(res.pca, select.var = list(contrib = 20))
# Change the color by groups, add ellipses
fviz_pca_biplot(res.pca, label="var", habillage=blups$notes,
addEllipses=TRUE, ellipse.level=0.95)
# Change the color by groups, add ellipses
fviz_pca_biplot(res.pca, label="var", habillage=blups[blups$Trt == 'HN', 'note'],
addEllipses=TRUE, ellipse.level=0.95)
# Change the color by groups, add ellipses
fviz_pca_biplot(res.pca, habillage=blups[blups$Trt == 'HN', 'note'],
addEllipses=TRUE, ellipse.level=0.95)
# Change the color by groups, add ellipses
fviz_pca_biplot(res.pca, label= FALSE, habillage=blups[blups$Trt == 'HN', 'note'],
addEllipses=TRUE, ellipse.level=0.95)
# Change the color by groups, add ellipses
fviz_pca_biplot(res.pca, label= none, habillage=blups[blups$Trt == 'HN', 'note'],
addEllipses=TRUE, ellipse.level=0.95)
# Change the color by groups, add ellipses
fviz_pca_biplot(res.pca, label= NONE, habillage=blups[blups$Trt == 'HN', 'note'],
addEllipses=TRUE, ellipse.level=0.95)
# Use points and text
fviz_pca_var(res.pca, geom = 'point')
# Use points and text
fviz_pca_var(res.pca)
# Use points and text
fviz_pca_var(res.pca, geom = 'point')
# Use points and text
fviz_pca_var(res.pca, geom = 'point', point.size= 0.5)
# Use points and text
fviz_pca_var(res.pca, geom = 'point', pointsize= 0.5)
# Use points and text
fviz_pca_var(res.pca, geom = 'point', pointsize= 0.3)
# Use points and text
fviz_pca_var(res.pca, geom = 'point', pointsize= 0.1)
# Use points and text
fviz_pca_var(res.pca, select.var = list(contrib = 20), geom = 'point', pointsize= 0.1)
# Use points and text
fviz_pca_var(res.pca, select.var = list(contrib = 100), geom = 'point', pointsize= 0.1)
# Use points and text
fviz_pca_var(res.pca, select.var = list(contrib = 500), geom = 'point', pointsize= 0.1)
# Use points and text
fviz_pca_var(res.pca, select.var = list(contrib =1000), geom = 'point', pointsize= 0.1)
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.96))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0075))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.00001))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0001))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0005))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.00015))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0002))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.00025))
res.pca <- prcomp(blups[blups$Trt== 'LN', 12:length(colnames(blups))], scale = FALSE)
# Control the transparency of variables using their contributions
fviz_pca_var(res.pca, alpha.var="contrib") +
theme_minimal()
# Select the top 3 contributing variables
fviz_pca_var(res.pca, select.var = list(contrib = 20))
# Change the color by groups, add ellipses
fviz_pca_biplot(res.pca, label= NONE, habillage=blups[blups$Trt == 'LN', 'note'],
addEllipses=TRUE, ellipse.level=0.95)
# Change the color by groups, add ellipses
fviz_pca_biplot(res.pca, label= FALSE, habillage=blups[blups$Trt == 'LN', 'note'],
addEllipses=TRUE, ellipse.level=0.95)
# Use points and text
fviz_pca_var(res.pca, select.var = list(contrib =1000), geom = 'point', pointsize= 0.1)
# Use points and text
fviz_pca_var(res.pca, select.var = list(contrib =1000) #, geom = 'point'#, pointsize= 0.1)
# Use points and text
fviz_pca_var(res.pca, select.var = list(contrib =1000), geom = 'point', pointsize= 0.1)
# Use points and text
fviz_pca_var(res.pca, select.var = list(contrib =1000), geom = 'point', pointsize= 0.1)
# Use lines
fviz_pca_var(res.pca, select.var = list(contrib =1000), pointsize= 0.1)
# Use lines
fviz_pca_var(res.pca, select.var = list(contrib =500), pointsize= 0.1)
# Use lines
fviz_pca_var(res.pca, select.var = list(contrib =1000), pointsize= 0.1)
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.00025))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.0002))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.00002))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.00003))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.00004))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.00005))
# Select and visualize variables with cos2 >= 0.96
fviz_pca_var(res.pca, select.var = list(cos2 = 0.00006))
fviz_pca_ind(res.pca, label="none", habillage=blups[blups$Trt == 'HN', 'note'])
res.pca <- prcomp(spectra, 12:length(colnames(spectra)), scale = FALSE)
res.pca <- prcomp(spectra[spectra$X350 != NA, ], 12:length(colnames(spectra)), scale = FALSE)
res.pca <- prcomp(spectra[spectra$X350 != 'NA', ], 12:length(colnames(spectra)), scale = FALSE)
res.pca <- prcomp(na.rm(spectra), 12:length(colnames(spectra)), scale = FALSE)
res.pca <- prcomp(drop.na(spectra), 12:length(colnames(spectra)), scale = FALSE)
res.pca <- prcomp(spectra, 12:length(colnames(spectra)), na.rm= TRUE, scale = FALSE)
res.pca <- prcomp(spectra[spectra$X350 != NA, ], 12:length(colnames(spectra)), scale = FALSE)
spectra %>% filter(a != NA)
library(tidyverse)
spectra %>% filter(X350 != NA)
spectra 2 <- spectra %>% filter(X350 != NA)
spectra2 <- spectra %>% filter(X350 != NA)
res.pca <- prcomp(spectra2,  12:length(colnames(spectra)), scale = FALSE)
View(spectra2)
spectra2 %>% drop_na()
res.pca <- prcomp(spectra2,  12:length(colnames(spectra)), scale = FALSE)
spectra2  <-  spectra %>% drop_na()
res.pca <- prcomp(spectra2,  12:length(colnames(spectra)), scale = FALSE)
View(spectra2)
res.pca <- prcomp(spectra2,  12:length(colnames(spectra2)), scale = FALSE)
res.pca <- prcomp(spectra2,  12:length(colnames(spectra2)), scale = FALSE)
spectra$Rep <- factor(spectra$Rep)
spectra$Block <- factor(spectra$Block)
spectra$year <- factor(spectra$year)
spectra$genotype <- factor(spectra$genotype)
spectra$note <- factor(spectra$note)
spectra$Trt <- factor(spectra$Trt)
spectra$ASD <- factor(spectra$ASD)
spectra2  <-  spectra %>% drop_na()
res.pca <- prcomp(spectra2,  12:length(colnames(spectra2)), scale = FALSE)
res.pca <- prcomp(spectra2,  12:20), scale = FALSE)
res.pca <- prcomp(spectra2[12:length(colnames(spectra2))], scale = FALSE)
fviz_pca_ind(res.pca, geom="point")
fviz_pca_ind(res.pca, label="none", habillage=spectra$Trt])
fviz_pca_ind(res.pca, label="none", habillage=spectra$Trt)
fviz_pca_ind(res.pca, label="none", habillage=spectra2$Trt)
fviz_pca_ind(res.pca, label="none", habillage=spectra2$notes)
fviz_pca_ind(res.pca, label="none", habillage=spectra2$note)
fviz_pca_ind(res.pca, label="none", habillage=spectra2$Trt)
res.pca <- prcomp(spectra2[spectra$Trt == 'HN', 12:length(colnames(spectra2))], scale = FALSE)
res.pca <- prcomp(spectra2[spectra2$Trt == 'HN', 12:length(colnames(spectra2))], scale = FALSE)
fviz_pca_ind(res.pca, geom="point")
fviz_pca_ind(res.pca, label="none", habillage=spectra2$Trt)
fviz_pca_ind(res.pca, label="none", habillage=spectra2$note)
fviz_pca_ind(res.pca, label="none", habillage=spectra2[spectra2$Trt == 'HN', 'note')]
fviz_pca_ind(res.pca, label="none", habillage=spectra2[spectra2$Trt == 'HN', 'note'])
res.pca <- prcomp(spectra2[spectra2$Trt == 'LN', 12:length(colnames(spectra2))], scale = FALSE)
fviz_pca_ind(res.pca, geom="point")
fviz_pca_ind(res.pca, label="none", habillage=spectra2[spectra2$Trt == 'LN', 'note'])
fviz_pca_ind(res.pca, label="none", habillage=spectra2[spectra2$Trt == 'LN', 'note'])
fviz_pca_ind(res.pca, label="none", habillage=spectra2[spectra2$Trt == 'LN', c('note','ASD')])
fviz_pca_ind(res.pca, label="none", habillage=spectra2[spectra2$Trt == 'LN', c('ASD')])
res.pca <- prcomp(bulps[,12:length(colnames(blups))], scale = FALSE)
res.pca <- prcomp(blups[,12:length(colnames(blups))], scale = FALSE)
fviz_pca_ind(res.pca, label="none", habillage=blups$Trt)
fviz_pca_ind(res.pca, label="none", habillage=blups[, c('Trt')]
p <- fviz_pca_ind(res.pca, label="none", habillage=blups[blups$Trt == 'LN', 'note'],
addEllipses=TRUE, ellipse.level=0.95)
fviz_pca_ind(res.pca, label="none", habillage=blups[, c('Trt')])
fviz_pca_ind(res.pca, label="none", habillage=blups[, c('Trt', 'note')])
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
geom_point()
ggplot(cbind(basic_plot$data, data[,c('Trt', 'note')]), aes(x=x, y=y, col = note, shape=Trt))+
geom_point()
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'note')]), aes(x=x, y=y, col = note, shape=Trt))+
geom_point()
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'note')]), aes(x='Dim', y=y, col = note, shape=Trt))+
geom_point()
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'note')]), aes(x=x, y=y, col = note, shape=Trt))+
geom_point()
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'note')]), aes(x=x, y=y, col = note, shape=Trt))+
geom_point()+
labs(x='11')
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'note')]), aes(x=x, y=y, col = note, shape=Trt))+
geom_point()+
labs(x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
View(basic_plot$data)
group <- c()
blups$note[1]
group <- c()
for(i in 1:length(blups$note)){
note <- blups$note[i]
if(note == 'Hybrid'){
group <- c(group, 'Hybrid')
}
else
group <- c(group, 'Inbred')
}
View(group)
group
blups %>% mutate(Group= group, .before= note)
View(blups)
blups <- blups %>% mutate(Group = group, .before= note)
res.pca <- prcomp(blups[,13:length(colnames(blups))], scale = FALSE)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'note')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point()+
labs(x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
ggplot(cbind(basic_plot$data, blups[,c('Group', 'note')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point()+
labs(x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
ggplot(cbind(basic_plot$data, blups[,c('Group', 'note')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point()+
labs(x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
res.pca <- prcomp(blups[,13:length(colnames(blups))], scale = FALSE)
basic_plot <- fviz_pca_ind(res.pca, label= 'none')
ggplot(cbind(basic_plot$data, blups[,c('Group', 'note')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point()+
labs(x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
fviz_pca_ind(res.pca, geom="point")
View(blups[,c('Group', 'note')]))
View(blups[,c('Group', 'note')])
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'note')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point()+
labs(x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point()+
labs(x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=0.8)+
labs(x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=1.5)+
labs(x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=1.7)+
labs(x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=1.7)+
labs(title = 'PCA' x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=1.7)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=1.7)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
theme_bw()
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=1.7)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=1.8)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse()+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(level= 0.99)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(level= 0.95)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(group= Trt , level= 0.95)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE, aes(x=x, y=y, group=Trt))+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE, aes(x=x, y=y, col=Trt))+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE, aes(x=x, y=y, col=Trt), show.legend = NA)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE, aes(x=x, y=y, col=Trt), show.legend = FALSE)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE, aes(x=x, y=y, col=Trt), show.legend = TRUE)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE, aes(x=x, y=y, col=Trt), show.legend = FALSE)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE, aes(x=x, y=y, col=Trt), show.legend = NA)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE, aes(x=x, y=y, col=Trt), show.legend = FALSE)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE, aes(x=x, y=y), show.legend = FALSE)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(inherit.aes = FALSE, aes(x=x, y=y, group =Group), show.legend = FALSE)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, col = Group, shape=Trt))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(show.legend = FALSE)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, shape=Trt, col = Group ))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(show.legend = FALSE)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, shape=Trt, col = Group ))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(type= norm)+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, shape=Trt, col = Group ))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(type= 'norm')+
theme_bw(14)
ggplot(cbind(basic_plot$data, blups[,c('Trt', 'Group')]), aes(x=x, y=y, shape=Trt, col = Group ))+
geom_point(size=2)+
labs(title = 'PCA', x='Dim1 (82.7%)', y= 'Dim2 (12.4%)')+
stat_ellipse(type= 't')+
theme_bw(14)
install.packages(gpbStat)
install.packages('gpbStat')
library(gpbStat)
hybrids <- blups[blups$note == 'Hybrid',]
View(hybrids)
hbrids <- hybrids %>% filter(grepl(' X ', genotype))
hbrids <- hybrids %>% filter(grepl(' X ', genotype))
View(hybrids)
hybrids <- blups[blups$note == 'Hybrid',]
hbrids <- hybrids %>% filter(grepl(' X ', genotype))
hbrids <- hybrids %>% filter(grepl(' X ', genotype))
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
hybrids <- hybrids %>% filter(grepl(' X ', hybrids$genotype))
View(hybrids)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', hybrids$genotype))
View(hybrids)
hybrids <- hybrids %>% filter(grepl(' X ', 'genotype'))
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', 'genotype'))
View(hybrids)
hybrids$gentoype <- as.character(hybrids$genotype)
hybrids$gentoype <- character(hybrids$genotype)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids$gentoype <- character(hybrids$genotype)
hybrids$gentoype <- as.character(hybrids$genotype)
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
hybrids <- hybrids %>% filter(grepl(' X ', hybrids$genotype))
View(hybrids)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids$gentoype <- as.character(hybrids$genotype)
hybrids <- hybrids %>% filter(grepl(' X ', hybrids$genotype))
View(hybrids)
hybrids <- blups[blups$note == 'Hybrid',]
hybrids$gentoype <- as.character(hybrids$genotype)
hybrids <- hybrids %>% filter(grepl(' X ',genotype))
hybrids <- blups[blups$note == 'Hybrid',]
hybrids$gentoype <- as.factor(hybrids$genotype)
hybrids <- hybrids %>% filter(grepl(' X ',genotype))
hybrids <- blups[blups$note == 'Hybrid',]
str(hybrids)
hybrids$gentoype <- as.factor(hybrids$genotype)
str(hybrids)
hybrids$gentoype <- factor(hybrids$genotype)
str(hybrids)
hybrids <- hybrids %>% filter(grepl(' X ',genotype))
hybrids <- blups[blups$note == 'Hybrid',]
hybrids$gentoype <- factor(hybrids$genotype)
str(hybrids)
hybrids <- hybrids %>% filter(grepl(' X ',genotype))
hybrids %>% filter(grepl(' X ',genotype))
hybrids <- blups[blups$note == 'Hybrid',]
hybrids %>% filter(grepl(' X ',genotype))
hybrids %>% filter(grepl(' X ', genotype))
hybrids %>% filter(grepl(' X ', factor(genotype)))
library(tidyverse)
hybrids %>% filter(grepl(' X ', genotype))
hybrids <- blups[blups$note == 'Hybrid',]
hybrids <- hybrids %>% filter(grepl(' X ', genotype))
View(hybrids)
female <- c()
male <- c()
for (i in 1:length(hybrids$note)){
h <- as.character(hybrids$genotype[i])
f <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][1]
m <- strsplit(as.character(het$genotype[i]), ' X ')[[1]][2]
female <- c(female, f)
male <- c(male, m)
}
male
